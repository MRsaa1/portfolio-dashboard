// Language Translations
const translations = {
    en: {
        // Navigation
        navHome: "Home",
        navAbout: "About",
        navResearch: "Research",
        navProjects: "Projects",
        navCertifications: "Certifications",
        navCV: "CV",
        navContact: "Contact",
        
        // Hero Section
        heroTitle: "Oleksii Slieptsov",
        heroSubtitle: "Treasury & Liquidity Expert",
        heroTagline: "AI Automation | SSRN Author | Ex-PrivatBank",
        btnViewResume: "View Resume",
        btnResearch: "Research",
        btnDownloadCV: "Download CV",
        
        // Impact Section
        impactSSRNViews: "SSRN Views",
        impactDownloads: "Downloads",
        impactResearchFields: "Research Fields",
        impactGitHubProjects: "GitHub Projects",
        impactYearsExperience: "Years Experience",
        impactTeamManaged: "Team Managed",
        impactPublications: "Publications",
        impactGitHubStars: "GitHub Stars",
        impactDailyTurnover: "Daily Turnover",
        
        // Sections
        sectionAbout: "About",
        sectionCertifications: "Professional Certifications",
        sectionTechStack: "Technology Stack",
        sectionResearch: "SSRN Publications",
        sectionProjects: "GitHub Projects",
        sectionResume: "Resume",
        sectionTimeline: "Career Timeline",
        sectionAwards: "Awards & Honors",
        sectionContact: "Contact",
        
        // Tech Stack Categories
        techLanguages: "Languages",
        techFrameworks: "Frameworks & Libraries",
        techFinancial: "Financial Technologies",
        techTools: "Tools & Platforms",
        
        // Certifications
        certActive: "Active",
        certInProgress: "In Progress",
        
        // Timeline
        timeline2025: "CFA, AFP, DACFP CBDA Certifications",
        timeline2025Desc: "Earned multiple professional certifications in finance and digital assets",
        timeline2024: "Transition to Fintech Development",
        timeline2024Desc: "Started building institutional-grade fintech solutions and AI trading platforms",
        timeline2013_2024: "Senior Banking Executive at PrivatBank",
        timeline2013_2024Desc: "Led team of 64 professionals, managed $50M daily operations, built automation systems",
        timeline2013_2016: "Bachelor's in Finance and Credit",
        timeline2013_2016Desc: "Ukrainian Academy of Banking of the National Bank of Ukraine",
        timeline2005: "Started at PrivatBank",
        timeline2005Desc: "Began career in treasury and liquidity management",
        timeline2001_2006: "Master's Degree",
        timeline2001_2006Desc: "Manager of Foreign Economic, Berdyansk Institute of Entrepreneurship (With Honors)",
        
        // Contact Form
        formTitle: "Send a Message",
        formName: "Name",
        formEmail: "Email",
        formSubject: "Subject",
        formMessage: "Message",
        formSend: "Send Message",
        formSuccess: "Thank you! Your message has been sent. I will get back to you soon.",
        formError: "Please fill in all required fields.",
        formEmailError: "Please enter a valid email address.",
        
        // Common
        viewOnSSRN: "View on SSRN →",
        viewOnGitHub: "View on GitHub →",
        downloadPDF: "Download PDF",
        downloadFullResume: "Download Full Resume (PDF)",
        
        // Resume Sections
        resumeExperience: "Professional Experience",
        resumeEducation: "Education",
        resumeCertifications: "Professional Certifications",
        resumeAwards: "Honors & Awards",
        resumeSkills: "Core Competencies",
        resumePublications: "Research & Publications",
        
        // Footer
        footerCopyright: "© 2025 SAA Alliance. All rights reserved."
    },
    ru: {
        // Navigation
        navHome: "Главная",
        navAbout: "О себе",
        navResearch: "Исследования",
        navProjects: "Проекты",
        navCertifications: "Сертификаты",
        navCV: "Резюме",
        navContact: "Контакты",
        
        // Hero Section
        heroTitle: "Олексій Слієпцов",
        heroSubtitle: "Эксперт по казначейству и ликвидности",
        heroTagline: "AI автоматизация | Автор SSRN | Бывший ПриватБанк",
        btnViewResume: "Посмотреть резюме",
        btnResearch: "Исследования",
        btnDownloadCV: "Скачать резюме",
        
        // Impact Section
        impactSSRNViews: "Просмотров SSRN",
        impactDownloads: "Скачиваний",
        impactResearchFields: "Областей исследований",
        impactGitHubProjects: "Проектов GitHub",
        impactYearsExperience: "Лет опыта",
        impactTeamManaged: "Человек в команде",
        impactPublications: "Публикаций",
        impactGitHubStars: "Звезд GitHub",
        impactDailyTurnover: "Ежедневный оборот",
        
        // Sections
        sectionAbout: "О себе",
        sectionCertifications: "Профессиональные сертификаты",
        sectionTechStack: "Технологический стек",
        sectionResearch: "Публикации SSRN",
        sectionProjects: "Проекты GitHub",
        sectionResume: "Резюме",
        sectionTimeline: "Карьерная хронология",
        sectionAwards: "Награды и достижения",
        sectionContact: "Контакты",
        
        // Tech Stack Categories
        techLanguages: "Языки программирования",
        techFrameworks: "Фреймворки и библиотеки",
        techFinancial: "Финансовые технологии",
        techTools: "Инструменты и платформы",
        
        // Certifications
        certActive: "Активен",
        certInProgress: "В процессе",
        
        // Timeline
        timeline2025: "Сертификаты CFA, AFP, DACFP CBDA",
        timeline2025Desc: "Получены множественные профессиональные сертификаты в области финансов и цифровых активов",
        timeline2024: "Переход к разработке финтех-решений",
        timeline2024Desc: "Начал создавать институциональные финтех-платформы и AI торговые системы",
        timeline2013_2024: "Старший банковский руководитель в ПриватБанке",
        timeline2013_2024Desc: "Руководил командой из 64 специалистов, управлял операциями на $50M ежедневно, создавал системы автоматизации",
        timeline2013_2016: "Бакалавр финансов и кредита",
        timeline2013_2016Desc: "Украинская академия банковского дела Национального банка Украины",
        timeline2005: "Начало работы в ПриватБанке",
        timeline2005Desc: "Начал карьеру в управлении казначейством и ликвидностью",
        timeline2001_2006: "Магистр",
        timeline2001_2006Desc: "Менеджер внешнеэкономической деятельности, Бердянский институт предпринимательства (с отличием)",
        
        // Contact Form
        formTitle: "Отправить сообщение",
        formName: "Имя",
        formEmail: "Email",
        formSubject: "Тема",
        formMessage: "Сообщение",
        formSend: "Отправить сообщение",
        formSuccess: "Спасибо! Ваше сообщение отправлено. Я свяжусь с вами в ближайшее время.",
        formError: "Пожалуйста, заполните все обязательные поля.",
        formEmailError: "Пожалуйста, введите корректный email адрес.",
        
        // Common
        viewOnSSRN: "Посмотреть на SSRN →",
        viewOnGitHub: "Посмотреть на GitHub →",
        downloadPDF: "Скачать PDF",
        downloadFullResume: "Скачать полное резюме (PDF)",
        
        // Resume Sections
        resumeExperience: "Профессиональный опыт",
        resumeEducation: "Образование",
        resumeCertifications: "Профессиональные сертификаты",
        resumeAwards: "Награды и достижения",
        resumeSkills: "Ключевые компетенции",
        resumePublications: "Исследования и публикации",
        
        // Footer
        footerCopyright: "© 2025 SAA Alliance. Все права защищены."
    }
};

// Language Switcher Function
function switchLanguage(lang) {
    const currentLang = lang || (localStorage.getItem('language') || 'en');
    const t = translations[currentLang];
    
    if (!t) {
        console.error('Translation not found for language:', currentLang);
        return;
    }
    
    // Find all elements with data-lang attributes
    const elements = document.querySelectorAll('[data-lang-en]');
    
    // Update all elements with data-lang attributes
    elements.forEach(element => {
        const key = element.getAttribute(`data-lang-${currentLang}`);
        if (!key) {
            console.warn('Translation key not found for element:', element);
            return;
        }
        
        try {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = key;
            } else if (element.tagName === 'BUTTON' || element.tagName === 'A') {
                // For buttons and links, update text content but preserve inner HTML structure
                const innerHTML = element.innerHTML;
                if (innerHTML.includes('<svg') || innerHTML.includes('<span')) {
                    // Preserve SVG/icons, only update text
                    const span = element.querySelector('span');
                    if (span) {
                        span.textContent = key;
                    } else {
                        // If no span, replace text but keep SVG
                        const textMatch = innerHTML.match(/>([^<]+)</);
                        if (textMatch) {
                            element.innerHTML = innerHTML.replace(textMatch[1], key);
                        } else {
                            // Fallback: just replace text
                            element.textContent = key;
                        }
                    }
                } else {
                    element.textContent = key;
                }
            } else if (element.tagName === 'STRONG' || element.tagName === 'EM') {
                // For strong/em tags, update text but preserve structure
                element.textContent = key;
            } else if (element.tagName === 'P' || element.tagName === 'DIV') {
                // For paragraphs and divs, check if they have nested elements
                const hasNestedElements = element.querySelector('strong, em, a, span');
                if (hasNestedElements && element.innerHTML.includes('<')) {
                    // If has nested elements, replace innerHTML to preserve structure
                    // The translation should include the HTML structure
                    element.innerHTML = key;
                } else {
                    // No nested elements, safe to replace text
                    element.textContent = key;
                }
            } else {
                // For all other elements (h1-h6, etc.)
                element.textContent = key;
            }
        } catch (error) {
            console.error('Error updating element:', element, error);
        }
    });
    
    // Update language indicator
    const langIndicator = document.getElementById('currentLang');
    if (langIndicator) {
        langIndicator.textContent = currentLang.toUpperCase();
    }
    
    // Save preference
    localStorage.setItem('language', currentLang);
    document.documentElement.lang = currentLang;
}

// Initialize language on page load
function initLanguage() {
    const savedLang = localStorage.getItem('language') || 'en';
    switchLanguage(savedLang);
    
    // Language switcher button
    const langSwitcher = document.getElementById('languageSwitcher');
    if (langSwitcher) {
        langSwitcher.addEventListener('click', function() {
            const currentLang = localStorage.getItem('language') || 'en';
            const newLang = currentLang === 'en' ? 'ru' : 'en';
            switchLanguage(newLang);
        });
    }
}

// Run on DOM ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initLanguage);
} else {
    // DOM already loaded
    initLanguage();
}

